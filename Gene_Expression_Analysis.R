#Load the Data
lungcancer=read.csv("/Users/Asish/Downloads/MAIN PROJECT/LungCancer-Harvard2/data.csv")
lungcancer

id=sample(2,nrow(lungcancer),prob = c(0.7,0.3) , replace = TRUE)
Train_Data= lungcancer[id==1,]
Test_Data=lungcancer[id==2,]
print(Test_Data$A1)
ncol(Train_Data)

#Information Gain to remove useless features

library(rJava)
library(FSelector)

weights <- information.gain(A1~., Train_Data)
print(weights)
subset <- cutoff.k(weights, 2)
f <- as.simple.formula(subset, "Cancer")
print(f)

weights <- gain.ratio(A1~., Train_Data)
print(weights)
subset <- cutoff.k(weights, 2)
f <- as.simple.formula(subset, "Cancer")
print(f)

#Correlation measure
weights <- symmetrical.uncertainty(A1~., Train_Data) 
print(weights)
subset <- cutoff.biggest.diff(weights)
f <- as.simple.formula(subset, "Cancer")
print(f)


#Model
#To Standardize the data Convert Target variable into factor
Train_Data[["A1"]] = factor(Train_Data[["A1"]])
print(is.factor(Train_Data$A1))
nlevels(Train_Data$A1)
Test_Data[["A1"]] = factor(Test_Data[["A1"]])
is.factor(Test_Data$A1)
trctrl <- trainControl(method = "repeatedcv", number = 10, repeats = 3)  #Control the computational nuances
print(trctrl)
set.seed(3233)

#SVM Model
library(caret)
svm_Linear <- train(A1 ~ A3335 + A542 + A3845 + A6572 + A7201 + A2550 + A8006 + 
                      A12115 + A7749 + A3334 + A12361 + A6140 + A4337 + A11471 + 
                      A8538 + A2422 + A7766 + A8181 + A12197 + A5302 + A9608 + 
                      A9708 + A870 + A3917 + A7626 + A12299 + A2256 + A8371 + A11016 + 
                      A1193 + A5980 + A11958 + A11959 + A2788 + A9824 + A11927 + 
                      A1272 + A3203 + A3913 + A4773 + A6735 + A1247 + A1674 + A3384 + 
                      A10520 + A12201 + A7047 + A7925 + A1086 + A2625 + A5752 + 
                      A7850 + A9759 + A10913 + A11842 + A8887 + A9699 + A3251 + 
                      A3765 + A7250 + A10175 + A9864 + A426 + A1223 + A1432 + A9844 + 
                      A11831 + A12309 + A2807 + A7008 + A7445 + A11672 + A11859 + 
                      A8109 + A2123 + A3362 + A3382 + A4084 + A12314 + A8394 + 
                      A183 + A898 + A1859 + A2206 + A2521 + A2728 + A8670 + A11523 + 
                      A634 + A9070 + A11829 + A3903 + A9404 + A9475 + A401 + A8081 + 
                      A2379 + A3509 + A7352 + A11858 + A4216 + A5105 + A5784 + 
                      A7355 + A7369 + A7853 + A8173 + A8565 + A9536 + A10387 + 
                      A11172 + A11832 + A3862 + A6406 + A10844 + A668 + A1183 + 
                      A2883 + A3507 + A11369 + A3390 + A4816 + A8710 + A9825 + 
                      A1783 + A2736 + A4244 + A5230 + A6095 + A6595 + A6725 + A7235 + 
                      A7707 + A7742 + A8061 + A8127 + A8514 + A11293 + A11771 + 
                      A2078 + A2670 + A6190 + A6242 + A11830 + A12174 + A3510 + 
                      A7081 + A12524 + A5 + A5357 + A7723 + A12255 + A7747 + A9766 + 
                      A6186 + A1769 + A7161 + A1575 + A4336 + A5797 + A7679 + A8830 + 
                      A9819 + A10213 + A4229 + A6305 + A6668 + A8248 + A8480 + 
                      A8786 + A9186 + A9683 + A10978 + A11960 + A6103 + A6541 + 
                      A6579 + A7796 + A8845 + A8902 + A9773 + A1302 + A2667 + A2823 + 
                      A6630 + A12408 + A12419 + A1144 + A2040 + A2222 + A8495 + 
                      A11530 + A1612 + A3288 + A10291 + A9858 + A749 + A3104 + 
                      A4251 + A10220 + A11857 + A7027 + A8276 + A1613 + A2908 + 
                      A1128 + A1145 + A3413 + A4120 + A4365 + A10777 + A11752 + 
                      A12187 + A331 + A909 + A910 + A919 + A927 + A1036 + A1850 + 
                      A2246 + A2721 + A2890 + A3836 + A3894 + A4743 + A4858 + A5705 + 
                      A5728 + A6393 + A6552 + A6853 + A7419 + A7892 + A8180 + A8309 + 
                      A8392 + A8859 + A9655 + A9815 + A9822 + A10119 + A10509 + 
                      A11270 + A11329 + A11671 + A11775 + A4380 + A5394 + A7328 + 
                      A8072 + A9845 + A10000 + A10875 + A11140 + A6734 + A12217 + 
                      A2844 + A3224 + A4822 + A5374 + A6129 + A6247 + A6954 + A7070 + 
                      A9229 + A3868 + A4349 + A12307 + A10212 + A12465 + A12021 + 
                      A958 + A1224 + A9469 + A10169 + A10214 + A10691 + A11589 + 
                      A11952 + A719 + A4762 + A3328 + A4191 + A4369 + A8452 + A9684 + 
                      A12079 + A10063 + A10713 + A12258 + A1766 + A957 + A5660 + 
                      A6822 + A7185 + A32 + A5659 + A7700 + A10043 + A10448 + A11227 + 
                      A5807 + A2063 + A4476 + A5751 + A6107 + A6231 + A7980 + A8070 + 
                      A10571 + A10895 + A11617 + A11772 + A11929 + A12171 + A3279 + 
                      A3338 + A6300 + A8717 + A9230 + A9300 + A9466 + A11115 + 
                      A11465 + A11834 + A12243 + A661 + A735 + A753 + A842 + A1194 + 
                      A1445 + A2245 + A2665 + A3669 + A3842 + A4633 + A4954 + A4973 + 
                      A8193 + A9245 + A9365 + A9454 + A10128 + A10932 + A11507 + 
                      A12123 + A12477 + A3174 + A3456 + A4719 + A5794 + A6547 + 
                      A6749 + A10473 + A11915 + A631 + A6165 + A6577 + A9482 + 
                      A6324 + A800 + A9313 + A11486 + A5836 + A5848 + A807 + A3284 + 
                      A5722 + A6582 + A10927 + A11271 + A12153 + A9132 + A7283 + 
                      A1304 + A4203 + A4709 + A5120 + A5854 + A6048 + A7412 + A10009 + 
                      A10926 + A11325 + A12145 + A2569 + A4125 + A6100 + A107 + 
                      A648 + A1137 + A2041 + A4790 + A6018 + A6533 + A6915 + A7049 + 
                      A8509 + A8741 + A9311 + A11705 + A8389 + A11259 + A5695 + 
                      A36 + A3123 + A3932 + A6534 + A12240 + A48 + A3280 + A4109 + 
                      A4760 + A4974 + A7978 + A8568 + A8780 + A11275 + A7692 + 
                      A10313 + A136 + A149 + A152 + A443 + A476 + A573 + A585 + 
                      A956 + A1087 + A1158 + A1300 + A1341 + A1362 + A1715 + A2069 + 
                      A2300 + A2380 + A2662 + A2680 + A2688 + A2693 + A2790 + A2881 + 
                      A2887 + A2939 + A3360 + A3451 + A3539 + A3570 + A3681 + A3728 + 
                      A3821 + A3885 + A3929 + A3930 + A4019 + A4119 + A4474 + A4677 + 
                      A4868 + A4913 + A5254 + A5335 + A5824 + A5865 + A6020 + A6092 + 
                      A6147 + A6155 + A6188 + A6245 + A6285 + A6565 + A6585 + A6835 + 
                      A7023 + A7078 + A7159 + A7353 + A7916 + A8046 + A8131 + A8174 + 
                      A8377 + A8431 + A8528 + A8569 + A8892 + A9095 + A9352 + A9458 + 
                      A9461 + A9473 + A9481 + A9597 + A9937 + A9987 + A9990 + A10342 + 
                      A10442 + A10810 + A10864 + A10911 + A11013 + A11214 + A11561 + 
                      A11607 + A12061 + A12067 + A12130 + A3937 + A11292 + A11919 + 
                      A9080 + A8639 + A12149 + A1564 + A2235 + A2896 + A4562 + 
                      A5063 + A6087 + A6171 + A10467 + A11247 + A11538 + A11622 + 
                      A12232 + A5249 + A8910 + A647 + A4712 + A6854 + A3514 + A4898 + 
                      A5945 + A7006 + A9020 + A11246 + A5399 + A9065 + A2522 + 
                      A6123 + A7701 + A9076 + A11053 + A12381 + A9312 + A11508 + 
                      A718 + A3350 + A6991 + A7915 + A9848 + A10876 + A11229 + 
                      A11865 + A504 + A530 + A1913 + A2581 + A3825 + A4007 + A4175 + 
                      A6091 + A6836 + A7720 + A7745 + A8489 + A8842 + A11051 + 
                      A11670 + A11794 + A12230 + A12430 + A599 + A8256 + A5959 + 
                      A344 + A1737 + A1880 + A1957 + A2019 + A2169 + A2375 + A3432 + 
                      A3465 + A3820 + A3841 + A4234 + A4612 + A4928 + A5052 + A5327 + 
                      A6263 + A6603 + A6811 + A8515 + A9202 + A10100 + A10566 + 
                      A10587 + A10616 + A11517 + A11774 + A12091 + A12484 + A8843 + 
                      A5470 + A11258 + A860 + A1006 + A1815 + A2067 + A2316 + A2332 + 
                      A3081 + A3363 + A3974 + A5658 + A5855 + A5938 + A6184 + A6490 + 
                      A6932 + A7756 + A8179 + A8224 + A8298 + A8608 + A8698 + A9099 + 
                      A9687 + A10845 + A10953 + A11395 + A12211 + A12249 + A1352 + 
                      A9610 + A12533 + A3790 + A7111 + A8543 + A4332 + A4425 + 
                      A5019 + A7231 + A8781 + A12208 + A334 + A10021 + A8396 + 
                      A12259 + A7999 + A8357 + A266 + A906 + A2839 + A3392 + A7001 + 
                      A7799 + A9116 + A12154 + A153 + A411 + A3694 + A6126 + A7363 + 
                      A8732 + A10472 + A11282 + A12075 + A35 + A3907 + A8929 + 
                      A10352 + A8844 + A3378 + A5358 + A9183 + A10402 + A687 + 
                      A2722 + A3412 + A3816 + A8878 + A9372 + A10319 + A11118 + 
                      A12030 + A9498 + A2829 + A5202 + A5282 + A9765 + A9829 + 
                      A11389 + A11956 + A7382 + A8450 + A4036 + A5336 + A7992 + 
                      A1172 + A882 + A2895 + A3491 + A9143 + A11629 + A2897 + A4195 + 
                      A4252 + A4907 + A7378 + A7895 + A12514 + A730 + A2121 + A2211 + 
                      A4717 + A5595 + A5864 + A7243 + A10110 + A10631 + A10781 + 
                      A12527 + A4523 + A641 + A1243 + A1386 + A1525 + A2960 + A5298 + 
                      A6070 + A6336 + A6707 + A7293 + A7558 + A8530 + A9573 + A10248 + 
                      A11137 + A11331 + A11895 + A1635 + A8695 + A3905 + A300 + 
                      A416 + A3349 + A6187 + A8798 + A786 + A9072 + A9849 + A669 + 
                      A1147 + A3330 + A7234 + A7829 + A8380 + A9786 + A10407 + 
                      A11902 + A12396 + A3846 + A22 + A274 + A297 + A405 + A417 + 
                      A480 + A511 + A524 + A529 + A655 + A698 + A774 + A789 + A863 + 
                      A952 + A981 + A1001 + A1004 + A1112 + A1152 + A1248 + A1266 + 
                      A1283 + A1293 + A1338 + A1346 + A1377 + A1401 + A1444 + A1451 + 
                      A1452 + A1488 + A1517 + A1531 + A1559 + A1591 + A1604 + A1684 + 
                      A1729 + A1753 + A1799 + A1804 + A1824 + A2008 + A2076 + A2216 + 
                      A2329 + A2355 + A2371 + A2478 + A2496 + A2508 + A2512 + A2580 + 
                      A2646 + A2651 + A2661 + A2675 + A2805 + A2816 + A2837 + A2910 + 
                      A2937 + A2988 + A3099 + A3155 + A3161 + A3171 + A3185 + A3202 + 
                      A3223 + A3237 + A3268 + A3270 + A3276 + A3299 + A3356 + A3357 + 
                      A3542 + A3553 + A3584 + A3622 + A3691 + A3764 + A3802 + A3829 + 
                      A3871 + A3908 + A3931 + A4035 + A4052 + A4053 + A4054 + A4058 + 
                      A4138 + A4294 + A4295 + A4314 + A4324 + A4387 + A4409 + A4436 + 
                      A4493 + A4569 + A4574 + A4596 + A4644 + A4658 + A4720 + A4784 + 
                      A4845 + A4865 + A4988 + A5126 + A5178 + A5182 + A5185 + A5220 + 
                      A5231 + A5297 + A5329 + A5549 + A5568 + A5585 + A5596 + A5605 + 
                      A5633 + A5686 + A5742 + A5744 + A5795 + A5817 + A5872 + A5930 + 
                      A5969 + A5976 + A6034 + A6067 + A6071 + A6130 + A6135 + A6149 + 
                      A6240 + A6308 + A6362 + A6372 + A6374 + A6379 + A6403 + A6429 + 
                      A6510 + A6687 + A6815 + A6820 + A6852 + A6906 + A6907 + A6944 + 
                      A6959 + A6973 + A6994 + A7017 + A7043 + A7112 + A7153 + A7154 + 
                      A7215 + A7246 + A7370 + A7429 + A7503 + A7569 + A7628 + A7702 + 
                      A7736 + A7740 + A7941 + A8035 + A8047 + A8063 + A8093 + A8097 + 
                      A8150 + A8194 + A8266 + A8426 + A8473 + A8498 + A8534 + A8548 + 
                      A8614 + A8628 + A8650 + A8658 + A8752 + A8777 + A8840 + A8904 + 
                      A8962 + A9042 + A9046 + A9061 + A9090 + A9133 + A9159 + A9194 + 
                      A9213 + A9254 + A9281 + A9362 + A9379 + A9451 + A9513 + A9523 + 
                      A9599 + A9679 + A9707 + A9721 + A9850 + A9923 + A9928 + A9984 + 
                      A9995 + A10015 + A10019 + A10107 + A10192 + A10556 + A10610 + 
                      A10721 + A10743 + A10760 + A10857 + A10974 + A10990 + A11076 + 
                      A11148 + A11205 + A11213 + A11295 + A11323 + A11416 + A11445 + 
                      A11462 + A11495 + A11509 + A11583 + A11754 + A11823 + A11854 + 
                      A11917 + A11976 + A12016 + A12017 + A12146 + A12207 + A12264 + 
                      A12344 + A12371 + A12399 + A12520 + A312 + A1134 + A1204 + 
                      A1212 + A4750 + A5747 + A5950 + A6222 + A7326 + A7647 + A7894 + 
                      A8038 + A9123 + A10236 + A10679 + A10952 + A11042 + A11299 + 
                      A11340 + A11882 + A1670 + A4320 + A6972 + A7693 + A7949 + 
                      A93 + A7454 + A8749 + A9447 + A3129 + A3406 + A10158 + A1019 + 
                      A1149 + A6961 + A9276 + A3692 + A3738 + A7473 + A7706 + A9693 + 
                      A352 + A764 + A2669 + A3114 + A5033 + A6665 + A10311 + A10383 + 
                      A11393 + A138 + A477 + A1082 + A1174 + A1950 + A2331 + A2503 + 
                      A2930 + A3115 + A3181 + A3375 + A3649 + A4290 + A4340 + A4667 + 
                      A4800 + A5367 + A5649 + A5926 + A6176 + A7876 + A7986 + A8011 + 
                      A8045 + A8243 + A8308 + A8362 + A8827 + A9000 + A10073 + 
                      A10440 + A10654 + A10695 + A11313 + A11398 + A11403 + A12212 + 
                      A12532 + A2549 + A6354 + A6064 + A7397 + A11304 + A1083 + 
                      A1595 + A2239 + A4796 + A5318 + A5338 + A6601 + A7532 + A9197 + 
                      A7248 + A7718 + A11819 + A3942 + A9661 + A11941 + A1213 + 
                      A3914 + A4198 + A7266 + A1228 + A4768 + A5137 + A5143 + A7309 + 
                      A7522 + A8521 + A11464 + A11636 + A11211 + A12161 + A6094 + 
                      A10506 + A1261 + A5219 + A10614 + A8801 + A523 + A2666 + 
                      A11442 + A11746 + A12385 + A102 + A120 + A847 + A1301 + A1313 + 
                      A1579 + A1933 + A2134 + A2207 + A3628 + A4620 + A4706 + A5262 + 
                      A5347 + A5830 + A6378 + A6520 + A6726 + A6823 + A7055 + A7368 + 
                      A7449 + A8033 + A9403 + A10750 + A11068 + A29 + A330 + A1659 + 
                      A2505 + A2597 + A4503 + A4880 + A5800 + A5827 + A7164 + A8750 + 
                      A9222 + A12375 + A8066 + A8134 + A10496 + A1235 + A2129 + 
                      A2638 + A4605 + A6116 + A8161 + A8484 + A9198 + A9419 + A10010 + 
                      A10539 + A1837 + A2234 + A4727 + A6521 + A8448 + A10290 + 
                      A10495 + A4729 + A3725 + A10724 + A12310 + A3429 + A8023 + 
                      A8316 + A9373 + A4218 + A4328 + A5173 + A5732 + A7669 + A8797 + 
                      A8847 + A10999 + A2520 + A2565 + A3249 + A4875 + A7212 + 
                      A7257 + A1269 + A6790 + A8525 + A8834 + A640 + A694 + A916 + 
                      A2238 + A4751 + A5767 + A7494 + A7710 + A8497 + A10294 + 
                      A1010 + A7688 + A9406 + A12001 + A3818 + A7075 + A10399 + 
                      A10584 + A11575 + A412 + A2135 + A3537 + A3742 + A3780 + 
                      A5032 + A5504 + A6748 + A6788 + A11664 + A1308 + A1627 + 
                      A5020 + A12247 + A3946 + A7240 + A10533 + A12441 + A5203 + 
                      A6488 + A7064 + A7324 + A10459 + A11766 + A5626 + A9729 + 
                      A852 + A1284 + A3260 + A4078 + A4243 + A4480 + A5233 + A7083 + 
                      A7470 + A7493 + A7716 + A8086 + A8460 + A8833 + A9110 + A9500 + 
                      A10120 + A12474 + A7189 + A9074 + A11515 + A311 + A532 + 
                      A902 + A983 + A2993 + A3160 + A3321 + A3329 + A3646 + A3647 + 
                      A3711 + A4844 + A5592 + A6010 + A6617 + A6648 + A6653 + A7205 + 
                      A7417 + A7513 + A8418 + A9784 + A12175 + A12510 + A727 + 
                      A6567 + A1028 + A12347 + A2111 + A3904 + A7814 + A12121 + 
                      A400 + A435 + A1056 + A2757 + A5197 + A8485 + A9678 + A108 + 
                      A653 + A1486 + A2073 + A11298 + A11961 + A1536 + A1148 + 
                      A2501 + A5677 + A10470 + A10742 + A5781 + A3568 + A8115 + 
                      A8424 + A7804 + A2493 + A4830 + A5664 + A8814 + A10132 + 
                      A9056 + A9105 + A10590 + A4254 + A10044 + A12389 + A3420 + 
                      A3897 + A4540 + A4650 + A1731 + A5796 + A6275 + A8675 + A8774 + 
                      A8826 + A9960 + A9993 + A12216 + A720 + A1237 + A2457 + A3556 + 
                      A3601 + A5539 + A5998 + A6564 + A6942 + A8125 + A11027 + 
                      A11677 + A12049 + A1570 + A1797 + A7249 + A7547 + A8071 + 
                      A12116 + A2024 + A1180 + A2902 + A4108 + A5389 + A6684 + 
                      A9136 + A654 + A1628 + A1814 + A2792 + A4091 + A6003 + A6208 + 
                      A7420 + A7685 + A9199 + A10136 + A12074 + A7058 + A238 + 
                      A3278 + A4331 + A5272 + A6688 + A11555 + A1334 + A2796 + 
                      A6795 + A2905 + A4004 + A8184 + A8340 + A78 + A139 + A1236 + 
                      A10723 + A1008 + A2159 + A2709 + A3699 + A4442 + A4943 + 
                      A5904 + A7270 + A7921 + A8339 + A10888 + A11750 + A1599 + 
                      A2629 + A6361 + A9582 + A10916 + A1465 + A9284 + A1025 + 
                      A3577 + A6352 + A8657 + A10069 + A10806 + A12035 + A873 + 
                      A3543 + A8234 + A8661 + A11577 + A127 + A834 + A5678 + A6753 + 
                      A8693 + A8849 + A8856 + A11565 + A12147 + A1260 + A3056 + 
                      A7076 + A923 + A3293 + A5988 + A7132 + A9442 + A9621 + A9846 + 
                      A9906 + A10543 + A11696 + A522 + A6173 + A7475 + A9991 + 
                      A1816 + A5608 + A6701 + A5882 + A302 + A954 + A2969 + A6839 + 
                      A7018 + A7345 + A10075 + A10843 + A296 + A562 + A1017 + A1928 + 
                      A6741 + A7060 + A7432 + A11277 + A11756 + A1101 + A3925 + 
                      A6204 + A7367 + A8751 + A8789 + A10538 + A6526 + A6662 + 
                      A10981 + A4684 + A9366 + A12295 + A6563 + A8979 + A1035 + 
                      A6819 + A7794 + A7835 + A9055 + A644 + A3795 + A6181 + A8342 + 
                      A846 + A1693 + A2528 + A7020 + A7704 + A8372 + A8641 + A12018 + 
                      A2119 + A3082 + A3612 + A4200 + A4675 + A5652 + A6454 + A6916 + 
                      A9288 + A10603 + A10803 + A5016 + A11922 + A2149 + A6692 + 
                      A9618 + A12367 + A4311 + A6487 + A11931 + A12048 + A4963 + 
                      A6024 + A6800 + A9428 + A10501 + A12464 + A4237 + A11621 + 
                      A1842 + A6137 + A8387 + A9604 + A11710 + A27 + A1052 + A1181 + 
                      A1871 + A2658 + A2732 + A2793 + A3938 + A4280 + A5929 + A8021 + 
                      A10858 + A566 + A1249 + A2042 + A2219 + A2649 + A4666 + A7414 + 
                      A9598 + A11569 + A12045 + A130 + A2328 + A2584 + A2956 + 
                      A6966 + A7450 + A8866 + A12089 + A12450 + A561 + A3037 + 
                      A3528 + A4001 + A5384 + A8085 + A10580 + A10660 + A498 + 
                      A582 + A3470 + A8526 + A11981 + A1997 + A5724 + A7406 + A7873 + 
                      A11890 + A680 + A6053 + A9894 + A1539 + A2291 + A3817 + A4859 + 
                      A5142 + A6209 + A6211 + A6643 + A11028 + A8761 + A5209 + 
                      A9190 + A5900 + A6183 + A6244 + A10449 + A12136 + A12530 + 
                      A492 + A555 + A4862 + A5018 + A8172 + A10643 + A11121 + A11130 + 
                      A12141 + A1645 + A5208 + A5502 + A5579 + A6265 + A6663 + 
                      A7514 + A1088 + A7032 + A9856 + A11485 + A548 + A826 + A3928 + 
                      A6981 + A7056 + A10298 + A10537 + A11503 + A990 + A4580 + 
                      A4708 + A6740 + A7091 + A8015 + A11641 + A1920 + A2356 + 
                      A4855 + A5733 + A6500 + A11673 + A12080 + A1510 + A3924 + 
                      A5324 + A7477 + A7831 + A12434 + A948 + A1662 + A7158 + A10441 + 
                      A10637 + A307 + A966 + A2032 + A4177 + A5084 + A5313 + A6674 + 
                      A9085 + A10464 + A12446 + A3091 + A8003 + A8388 + A8564 + 
                      A11674 + A3309 + A3613 + A4870 + A7233 + A9495 + A10306 + 
                      A10357 + A2628 + A6294 + A8303 + A9124 + A527 + A2961 + A4271 + 
                      A6933 + A7809 + A8855 + A11085 + A12251 + A591 + A2144 + 
                      A10118 + A11892 + A12199 + A862 + A1232 + A3919 + A4526 + 
                      A5874 + A5919 + A7198 + A8414 + A10809 + A12395 + A82 + A3097 + 
                      A11448 + A4567 + A8520 + A10640 + A12099 + A610 + A2443 + 
                      A4496 + A5661 + A6041 + A7948 + A8918 + A10354 + A11600 + 
                      A499 + A3257 + A5701 + A6995 + A9220 + A11318 + A12281 + 
                      A77 + A1677 + A5559 + A7338 + A8683 + A8857 + A9427 + A10859 + 
                      A468 + A2046 + A6988 + A8791 + A11436 + A3405 + A4309 + A4346 + 
                      A7630 + A9571 + A10948 + A114 + A777 + A969 + A2577 + A3196 + 
                      A4971 + A5770 + A7061 + A7964 + A9973 + A2303 + A2780 + A2808 + 
                      A4506 + A7317 + A7886 + A6864 + A7067 + A7325 + A7350 + A10860 + 
                      A137 + A7536 + A9094 + A11043 + A11116 + A2817 + A3112 + 
                      A7052 + A9763 + A10310 + A10866 + A10993 + A12358 + A2108 + 
                      A2310 + A5388 + A6042 + A8315 + A8793 + A9965 + A338 + A361 + 
                      A4621 + A4828 + A5375 + A5776 + A7080 + A10656 + A11791 + 
                      A12046 + A1514 + A2247 + A4024 + A5804 + A6522 + A10392 + 
                      A11739 + A445 + A3976 + A6085 + A9457 + A11188 + A2071 + 
                      A2311 + A4317 + A4472 + A5299 + A7307 + A8330 + A9945 + A11731 + 
                      A12274 + A7421 + A9025 + A10421 + A11887 + A12198 + A2091 + 
                      A3530 + A5901 + A7652 + A9073 + A10918 + A5071 + A5132 + 
                      A7672 + A8027 + A8870 + A9005 + A9142 + A9496 + A10665 + 
                      A234 + A533 + A4945 + A5348 + A6297 + A8853 + A9870 + A10121 + 
                      A12088 + A2880 + A3945 + A5382 + A5569 + A5838 + A5960 + 
                      A7287 + A8028 + A9767 + A10969 + A11108 + A11120 + A11681 + 
                      A126 + A1838 + A2075 + A2585 + A6256 + A6876 + A7810 + A8466 + 
                      A10371 + A10826 + A6589 + A8026 + A11338 + A11521 + A3709 + 
                      A5852 + A8940 + A398 + A3525 + A4722 + A6224 + A7021 + A7193 + 
                      A8760 + A10871 + A11526 + A12156 + A12183 + A12278 + A1277 + 
                      A1678 + A2189 + A2259 + A3534 + A4015 + A5967 + A7062 + A8599 + 
                      A10241 + A11198 + A259 + A408 + A1881 + A5086 + A9283 + A10092 + 
                      A11433 + A11557 + A2242 + A4884 + A5606 + A5639 + A9704 + 
                      A9791 + A9806 + A904 + A1231 + A2092 + A3193 + A5232 + A5471 + 
                      A5886 + A8053 + A8238 + A8616 + A9911 + A10992 + A431 + A1585 + 
                      A4951 + A5866 + A6101 + A8681 + A9750 + A11648 + A12196 + 
                      A12305 + A12531 + A866 + A5385 + A7094 + A11873 + A351 + 
                      A978 + A3103 + A3657 + A3730 + A4263 + A4687 + A4705 + A6127 + 
                      A7278 + A7360 + A8242 + A8376 + A8560 + A11627, data = Train_Data, method = "svmLinear",
                    trControl=trctrl,
                    preProcess = c("center", "scale"),
                    tuneLength = 10)
print(svm_Linear)

#Predict the test data
test_pred <- predict(svm_Linear, newdata = Test_Data)
print(test_pred)

#Accuracy (Confusion Matrics)
confusionMatrix(test_pred,Test_Data$A1)
is.factor(test_pred)
is.factor(Train_Data$A1)

#customizations for selecting C value(Cost) in Linear classifier
grid <- expand.grid(C = c(0.01, 0.05, 0.1, 0.25, 0.5, 0.75, 1, 1.25, 1.5, 1.75, 2,5))
set.seed(3233)
svm_Linear_Grid <- train(A1 ~ A3335 + A542 + A3845 + A6572 + A7201 + A2550 + A8006 + 
                           A12115 + A7749 + A3334 + A12361 + A6140 + A4337 + A11471 + 
                           A8538 + A2422 + A7766 + A8181 + A12197 + A5302 + A9608 + 
                           A9708 + A870 + A3917 + A7626 + A12299 + A2256 + A8371 + A11016 + 
                           A1193 + A5980 + A11958 + A11959 + A2788 + A9824 + A11927 + 
                           A1272 + A3203 + A3913 + A4773 + A6735 + A1247 + A1674 + A3384 + 
                           A10520 + A12201 + A7047 + A7925 + A1086 + A2625 + A5752 + 
                           A7850 + A9759 + A10913 + A11842 + A8887 + A9699 + A3251 + 
                           A3765 + A7250 + A10175 + A9864 + A426 + A1223 + A1432 + A9844 + 
                           A11831 + A12309 + A2807 + A7008 + A7445 + A11672 + A11859 + 
                           A8109 + A2123 + A3362 + A3382 + A4084 + A12314 + A8394 + 
                           A183 + A898 + A1859 + A2206 + A2521 + A2728 + A8670 + A11523 + 
                           A634 + A9070 + A11829 + A3903 + A9404 + A9475 + A401 + A8081 + 
                           A2379 + A3509 + A7352 + A11858 + A4216 + A5105 + A5784 + 
                           A7355 + A7369 + A7853 + A8173 + A8565 + A9536 + A10387 + 
                           A11172 + A11832 + A3862 + A6406 + A10844 + A668 + A1183 + 
                           A2883 + A3507 + A11369 + A3390 + A4816 + A8710 + A9825 + 
                           A1783 + A2736 + A4244 + A5230 + A6095 + A6595 + A6725 + A7235 + 
                           A7707 + A7742 + A8061 + A8127 + A8514 + A11293 + A11771 + 
                           A2078 + A2670 + A6190 + A6242 + A11830 + A12174 + A3510 + 
                           A7081 + A12524 + A5 + A5357 + A7723 + A12255 + A7747 + A9766 + 
                           A6186 + A1769 + A7161 + A1575 + A4336 + A5797 + A7679 + A8830 + 
                           A9819 + A10213 + A4229 + A6305 + A6668 + A8248 + A8480 + 
                           A8786 + A9186 + A9683 + A10978 + A11960 + A6103 + A6541 + 
                           A6579 + A7796 + A8845 + A8902 + A9773 + A1302 + A2667 + A2823 + 
                           A6630 + A12408 + A12419 + A1144 + A2040 + A2222 + A8495 + 
                           A11530 + A1612 + A3288 + A10291 + A9858 + A749 + A3104 + 
                           A4251 + A10220 + A11857 + A7027 + A8276 + A1613 + A2908 + 
                           A1128 + A1145 + A3413 + A4120 + A4365 + A10777 + A11752 + 
                           A12187 + A331 + A909 + A910 + A919 + A927 + A1036 + A1850 + 
                           A2246 + A2721 + A2890 + A3836 + A3894 + A4743 + A4858 + A5705 + 
                           A5728 + A6393 + A6552 + A6853 + A7419 + A7892 + A8180 + A8309 + 
                           A8392 + A8859 + A9655 + A9815 + A9822 + A10119 + A10509 + 
                           A11270 + A11329 + A11671 + A11775 + A4380 + A5394 + A7328 + 
                           A8072 + A9845 + A10000 + A10875 + A11140 + A6734 + A12217 + 
                           A2844 + A3224 + A4822 + A5374 + A6129 + A6247 + A6954 + A7070 + 
                           A9229 + A3868 + A4349 + A12307 + A10212 + A12465 + A12021 + 
                           A958 + A1224 + A9469 + A10169 + A10214 + A10691 + A11589 + 
                           A11952 + A719 + A4762 + A3328 + A4191 + A4369 + A8452 + A9684 + 
                           A12079 + A10063 + A10713 + A12258 + A1766 + A957 + A5660 + 
                           A6822 + A7185 + A32 + A5659 + A7700 + A10043 + A10448 + A11227 + 
                           A5807 + A2063 + A4476 + A5751 + A6107 + A6231 + A7980 + A8070 + 
                           A10571 + A10895 + A11617 + A11772 + A11929 + A12171 + A3279 + 
                           A3338 + A6300 + A8717 + A9230 + A9300 + A9466 + A11115 + 
                           A11465 + A11834 + A12243 + A661 + A735 + A753 + A842 + A1194 + 
                           A1445 + A2245 + A2665 + A3669 + A3842 + A4633 + A4954 + A4973 + 
                           A8193 + A9245 + A9365 + A9454 + A10128 + A10932 + A11507 + 
                           A12123 + A12477 + A3174 + A3456 + A4719 + A5794 + A6547 + 
                           A6749 + A10473 + A11915 + A631 + A6165 + A6577 + A9482 + 
                           A6324 + A800 + A9313 + A11486 + A5836 + A5848 + A807 + A3284 + 
                           A5722 + A6582 + A10927 + A11271 + A12153 + A9132 + A7283 + 
                           A1304 + A4203 + A4709 + A5120 + A5854 + A6048 + A7412 + A10009 + 
                           A10926 + A11325 + A12145 + A2569 + A4125 + A6100 + A107 + 
                           A648 + A1137 + A2041 + A4790 + A6018 + A6533 + A6915 + A7049 + 
                           A8509 + A8741 + A9311 + A11705 + A8389 + A11259 + A5695 + 
                           A36 + A3123 + A3932 + A6534 + A12240 + A48 + A3280 + A4109 + 
                           A4760 + A4974 + A7978 + A8568 + A8780 + A11275 + A7692 + 
                           A10313 + A136 + A149 + A152 + A443 + A476 + A573 + A585 + 
                           A956 + A1087 + A1158 + A1300 + A1341 + A1362 + A1715 + A2069 + 
                           A2300 + A2380 + A2662 + A2680 + A2688 + A2693 + A2790 + A2881 + 
                           A2887 + A2939 + A3360 + A3451 + A3539 + A3570 + A3681 + A3728 + 
                           A3821 + A3885 + A3929 + A3930 + A4019 + A4119 + A4474 + A4677 + 
                           A4868 + A4913 + A5254 + A5335 + A5824 + A5865 + A6020 + A6092 + 
                           A6147 + A6155 + A6188 + A6245 + A6285 + A6565 + A6585 + A6835 + 
                           A7023 + A7078 + A7159 + A7353 + A7916 + A8046 + A8131 + A8174 + 
                           A8377 + A8431 + A8528 + A8569 + A8892 + A9095 + A9352 + A9458 + 
                           A9461 + A9473 + A9481 + A9597 + A9937 + A9987 + A9990 + A10342 + 
                           A10442 + A10810 + A10864 + A10911 + A11013 + A11214 + A11561 + 
                           A11607 + A12061 + A12067 + A12130 + A3937 + A11292 + A11919 + 
                           A9080 + A8639 + A12149 + A1564 + A2235 + A2896 + A4562 + 
                           A5063 + A6087 + A6171 + A10467 + A11247 + A11538 + A11622 + 
                           A12232 + A5249 + A8910 + A647 + A4712 + A6854 + A3514 + A4898 + 
                           A5945 + A7006 + A9020 + A11246 + A5399 + A9065 + A2522 + 
                           A6123 + A7701 + A9076 + A11053 + A12381 + A9312 + A11508 + 
                           A718 + A3350 + A6991 + A7915 + A9848 + A10876 + A11229 + 
                           A11865 + A504 + A530 + A1913 + A2581 + A3825 + A4007 + A4175 + 
                           A6091 + A6836 + A7720 + A7745 + A8489 + A8842 + A11051 + 
                           A11670 + A11794 + A12230 + A12430 + A599 + A8256 + A5959 + 
                           A344 + A1737 + A1880 + A1957 + A2019 + A2169 + A2375 + A3432 + 
                           A3465 + A3820 + A3841 + A4234 + A4612 + A4928 + A5052 + A5327 + 
                           A6263 + A6603 + A6811 + A8515 + A9202 + A10100 + A10566 + 
                           A10587 + A10616 + A11517 + A11774 + A12091 + A12484 + A8843 + 
                           A5470 + A11258 + A860 + A1006 + A1815 + A2067 + A2316 + A2332 + 
                           A3081 + A3363 + A3974 + A5658 + A5855 + A5938 + A6184 + A6490 + 
                           A6932 + A7756 + A8179 + A8224 + A8298 + A8608 + A8698 + A9099 + 
                           A9687 + A10845 + A10953 + A11395 + A12211 + A12249 + A1352 + 
                           A9610 + A12533 + A3790 + A7111 + A8543 + A4332 + A4425 + 
                           A5019 + A7231 + A8781 + A12208 + A334 + A10021 + A8396 + 
                           A12259 + A7999 + A8357 + A266 + A906 + A2839 + A3392 + A7001 + 
                           A7799 + A9116 + A12154 + A153 + A411 + A3694 + A6126 + A7363 + 
                           A8732 + A10472 + A11282 + A12075 + A35 + A3907 + A8929 + 
                           A10352 + A8844 + A3378 + A5358 + A9183 + A10402 + A687 + 
                           A2722 + A3412 + A3816 + A8878 + A9372 + A10319 + A11118 + 
                           A12030 + A9498 + A2829 + A5202 + A5282 + A9765 + A9829 + 
                           A11389 + A11956 + A7382 + A8450 + A4036 + A5336 + A7992 + 
                           A1172 + A882 + A2895 + A3491 + A9143 + A11629 + A2897 + A4195 + 
                           A4252 + A4907 + A7378 + A7895 + A12514 + A730 + A2121 + A2211 + 
                           A4717 + A5595 + A5864 + A7243 + A10110 + A10631 + A10781 + 
                           A12527 + A4523 + A641 + A1243 + A1386 + A1525 + A2960 + A5298 + 
                           A6070 + A6336 + A6707 + A7293 + A7558 + A8530 + A9573 + A10248 + 
                           A11137 + A11331 + A11895 + A1635 + A8695 + A3905 + A300 + 
                           A416 + A3349 + A6187 + A8798 + A786 + A9072 + A9849 + A669 + 
                           A1147 + A3330 + A7234 + A7829 + A8380 + A9786 + A10407 + 
                           A11902 + A12396 + A3846 + A22 + A274 + A297 + A405 + A417 + 
                           A480 + A511 + A524 + A529 + A655 + A698 + A774 + A789 + A863 + 
                           A952 + A981 + A1001 + A1004 + A1112 + A1152 + A1248 + A1266 + 
                           A1283 + A1293 + A1338 + A1346 + A1377 + A1401 + A1444 + A1451 + 
                           A1452 + A1488 + A1517 + A1531 + A1559 + A1591 + A1604 + A1684 + 
                           A1729 + A1753 + A1799 + A1804 + A1824 + A2008 + A2076 + A2216 + 
                           A2329 + A2355 + A2371 + A2478 + A2496 + A2508 + A2512 + A2580 + 
                           A2646 + A2651 + A2661 + A2675 + A2805 + A2816 + A2837 + A2910 + 
                           A2937 + A2988 + A3099 + A3155 + A3161 + A3171 + A3185 + A3202 + 
                           A3223 + A3237 + A3268 + A3270 + A3276 + A3299 + A3356 + A3357 + 
                           A3542 + A3553 + A3584 + A3622 + A3691 + A3764 + A3802 + A3829 + 
                           A3871 + A3908 + A3931 + A4035 + A4052 + A4053 + A4054 + A4058 + 
                           A4138 + A4294 + A4295 + A4314 + A4324 + A4387 + A4409 + A4436 + 
                           A4493 + A4569 + A4574 + A4596 + A4644 + A4658 + A4720 + A4784 + 
                           A4845 + A4865 + A4988 + A5126 + A5178 + A5182 + A5185 + A5220 + 
                           A5231 + A5297 + A5329 + A5549 + A5568 + A5585 + A5596 + A5605 + 
                           A5633 + A5686 + A5742 + A5744 + A5795 + A5817 + A5872 + A5930 + 
                           A5969 + A5976 + A6034 + A6067 + A6071 + A6130 + A6135 + A6149 + 
                           A6240 + A6308 + A6362 + A6372 + A6374 + A6379 + A6403 + A6429 + 
                           A6510 + A6687 + A6815 + A6820 + A6852 + A6906 + A6907 + A6944 + 
                           A6959 + A6973 + A6994 + A7017 + A7043 + A7112 + A7153 + A7154 + 
                           A7215 + A7246 + A7370 + A7429 + A7503 + A7569 + A7628 + A7702 + 
                           A7736 + A7740 + A7941 + A8035 + A8047 + A8063 + A8093 + A8097 + 
                           A8150 + A8194 + A8266 + A8426 + A8473 + A8498 + A8534 + A8548 + 
                           A8614 + A8628 + A8650 + A8658 + A8752 + A8777 + A8840 + A8904 + 
                           A8962 + A9042 + A9046 + A9061 + A9090 + A9133 + A9159 + A9194 + 
                           A9213 + A9254 + A9281 + A9362 + A9379 + A9451 + A9513 + A9523 + 
                           A9599 + A9679 + A9707 + A9721 + A9850 + A9923 + A9928 + A9984 + 
                           A9995 + A10015 + A10019 + A10107 + A10192 + A10556 + A10610 + 
                           A10721 + A10743 + A10760 + A10857 + A10974 + A10990 + A11076 + 
                           A11148 + A11205 + A11213 + A11295 + A11323 + A11416 + A11445 + 
                           A11462 + A11495 + A11509 + A11583 + A11754 + A11823 + A11854 + 
                           A11917 + A11976 + A12016 + A12017 + A12146 + A12207 + A12264 + 
                           A12344 + A12371 + A12399 + A12520 + A312 + A1134 + A1204 + 
                           A1212 + A4750 + A5747 + A5950 + A6222 + A7326 + A7647 + A7894 + 
                           A8038 + A9123 + A10236 + A10679 + A10952 + A11042 + A11299 + 
                           A11340 + A11882 + A1670 + A4320 + A6972 + A7693 + A7949 + 
                           A93 + A7454 + A8749 + A9447 + A3129 + A3406 + A10158 + A1019 + 
                           A1149 + A6961 + A9276 + A3692 + A3738 + A7473 + A7706 + A9693 + 
                           A352 + A764 + A2669 + A3114 + A5033 + A6665 + A10311 + A10383 + 
                           A11393 + A138 + A477 + A1082 + A1174 + A1950 + A2331 + A2503 + 
                           A2930 + A3115 + A3181 + A3375 + A3649 + A4290 + A4340 + A4667 + 
                           A4800 + A5367 + A5649 + A5926 + A6176 + A7876 + A7986 + A8011 + 
                           A8045 + A8243 + A8308 + A8362 + A8827 + A9000 + A10073 + 
                           A10440 + A10654 + A10695 + A11313 + A11398 + A11403 + A12212 + 
                           A12532 + A2549 + A6354 + A6064 + A7397 + A11304 + A1083 + 
                           A1595 + A2239 + A4796 + A5318 + A5338 + A6601 + A7532 + A9197 + 
                           A7248 + A7718 + A11819 + A3942 + A9661 + A11941 + A1213 + 
                           A3914 + A4198 + A7266 + A1228 + A4768 + A5137 + A5143 + A7309 + 
                           A7522 + A8521 + A11464 + A11636 + A11211 + A12161 + A6094 + 
                           A10506 + A1261 + A5219 + A10614 + A8801 + A523 + A2666 + 
                           A11442 + A11746 + A12385 + A102 + A120 + A847 + A1301 + A1313 + 
                           A1579 + A1933 + A2134 + A2207 + A3628 + A4620 + A4706 + A5262 + 
                           A5347 + A5830 + A6378 + A6520 + A6726 + A6823 + A7055 + A7368 + 
                           A7449 + A8033 + A9403 + A10750 + A11068 + A29 + A330 + A1659 + 
                           A2505 + A2597 + A4503 + A4880 + A5800 + A5827 + A7164 + A8750 + 
                           A9222 + A12375 + A8066 + A8134 + A10496 + A1235 + A2129 + 
                           A2638 + A4605 + A6116 + A8161 + A8484 + A9198 + A9419 + A10010 + 
                           A10539 + A1837 + A2234 + A4727 + A6521 + A8448 + A10290 + 
                           A10495 + A4729 + A3725 + A10724 + A12310 + A3429 + A8023 + 
                           A8316 + A9373 + A4218 + A4328 + A5173 + A5732 + A7669 + A8797 + 
                           A8847 + A10999 + A2520 + A2565 + A3249 + A4875 + A7212 + 
                           A7257 + A1269 + A6790 + A8525 + A8834 + A640 + A694 + A916 + 
                           A2238 + A4751 + A5767 + A7494 + A7710 + A8497 + A10294 + 
                           A1010 + A7688 + A9406 + A12001 + A3818 + A7075 + A10399 + 
                           A10584 + A11575 + A412 + A2135 + A3537 + A3742 + A3780 + 
                           A5032 + A5504 + A6748 + A6788 + A11664 + A1308 + A1627 + 
                           A5020 + A12247 + A3946 + A7240 + A10533 + A12441 + A5203 + 
                           A6488 + A7064 + A7324 + A10459 + A11766 + A5626 + A9729 + 
                           A852 + A1284 + A3260 + A4078 + A4243 + A4480 + A5233 + A7083 + 
                           A7470 + A7493 + A7716 + A8086 + A8460 + A8833 + A9110 + A9500 + 
                           A10120 + A12474 + A7189 + A9074 + A11515 + A311 + A532 + 
                           A902 + A983 + A2993 + A3160 + A3321 + A3329 + A3646 + A3647 + 
                           A3711 + A4844 + A5592 + A6010 + A6617 + A6648 + A6653 + A7205 + 
                           A7417 + A7513 + A8418 + A9784 + A12175 + A12510 + A727 + 
                           A6567 + A1028 + A12347 + A2111 + A3904 + A7814 + A12121 + 
                           A400 + A435 + A1056 + A2757 + A5197 + A8485 + A9678 + A108 + 
                           A653 + A1486 + A2073 + A11298 + A11961 + A1536 + A1148 + 
                           A2501 + A5677 + A10470 + A10742 + A5781 + A3568 + A8115 + 
                           A8424 + A7804 + A2493 + A4830 + A5664 + A8814 + A10132 + 
                           A9056 + A9105 + A10590 + A4254 + A10044 + A12389 + A3420 + 
                           A3897 + A4540 + A4650 + A1731 + A5796 + A6275 + A8675 + A8774 + 
                           A8826 + A9960 + A9993 + A12216 + A720 + A1237 + A2457 + A3556 + 
                           A3601 + A5539 + A5998 + A6564 + A6942 + A8125 + A11027 + 
                           A11677 + A12049 + A1570 + A1797 + A7249 + A7547 + A8071 + 
                           A12116 + A2024 + A1180 + A2902 + A4108 + A5389 + A6684 + 
                           A9136 + A654 + A1628 + A1814 + A2792 + A4091 + A6003 + A6208 + 
                           A7420 + A7685 + A9199 + A10136 + A12074 + A7058 + A238 + 
                           A3278 + A4331 + A5272 + A6688 + A11555 + A1334 + A2796 + 
                           A6795 + A2905 + A4004 + A8184 + A8340 + A78 + A139 + A1236 + 
                           A10723 + A1008 + A2159 + A2709 + A3699 + A4442 + A4943 + 
                           A5904 + A7270 + A7921 + A8339 + A10888 + A11750 + A1599 + 
                           A2629 + A6361 + A9582 + A10916 + A1465 + A9284 + A1025 + 
                           A3577 + A6352 + A8657 + A10069 + A10806 + A12035 + A873 + 
                           A3543 + A8234 + A8661 + A11577 + A127 + A834 + A5678 + A6753 + 
                           A8693 + A8849 + A8856 + A11565 + A12147 + A1260 + A3056 + 
                           A7076 + A923 + A3293 + A5988 + A7132 + A9442 + A9621 + A9846 + 
                           A9906 + A10543 + A11696 + A522 + A6173 + A7475 + A9991 + 
                           A1816 + A5608 + A6701 + A5882 + A302 + A954 + A2969 + A6839 + 
                           A7018 + A7345 + A10075 + A10843 + A296 + A562 + A1017 + A1928 + 
                           A6741 + A7060 + A7432 + A11277 + A11756 + A1101 + A3925 + 
                           A6204 + A7367 + A8751 + A8789 + A10538 + A6526 + A6662 + 
                           A10981 + A4684 + A9366 + A12295 + A6563 + A8979 + A1035 + 
                           A6819 + A7794 + A7835 + A9055 + A644 + A3795 + A6181 + A8342 + 
                           A846 + A1693 + A2528 + A7020 + A7704 + A8372 + A8641 + A12018 + 
                           A2119 + A3082 + A3612 + A4200 + A4675 + A5652 + A6454 + A6916 + 
                           A9288 + A10603 + A10803 + A5016 + A11922 + A2149 + A6692 + 
                           A9618 + A12367 + A4311 + A6487 + A11931 + A12048 + A4963 + 
                           A6024 + A6800 + A9428 + A10501 + A12464 + A4237 + A11621 + 
                           A1842 + A6137 + A8387 + A9604 + A11710 + A27 + A1052 + A1181 + 
                           A1871 + A2658 + A2732 + A2793 + A3938 + A4280 + A5929 + A8021 + 
                           A10858 + A566 + A1249 + A2042 + A2219 + A2649 + A4666 + A7414 + 
                           A9598 + A11569 + A12045 + A130 + A2328 + A2584 + A2956 + 
                           A6966 + A7450 + A8866 + A12089 + A12450 + A561 + A3037 + 
                           A3528 + A4001 + A5384 + A8085 + A10580 + A10660 + A498 + 
                           A582 + A3470 + A8526 + A11981 + A1997 + A5724 + A7406 + A7873 + 
                           A11890 + A680 + A6053 + A9894 + A1539 + A2291 + A3817 + A4859 + 
                           A5142 + A6209 + A6211 + A6643 + A11028 + A8761 + A5209 + 
                           A9190 + A5900 + A6183 + A6244 + A10449 + A12136 + A12530 + 
                           A492 + A555 + A4862 + A5018 + A8172 + A10643 + A11121 + A11130 + 
                           A12141 + A1645 + A5208 + A5502 + A5579 + A6265 + A6663 + 
                           A7514 + A1088 + A7032 + A9856 + A11485 + A548 + A826 + A3928 + 
                           A6981 + A7056 + A10298 + A10537 + A11503 + A990 + A4580 + 
                           A4708 + A6740 + A7091 + A8015 + A11641 + A1920 + A2356 + 
                           A4855 + A5733 + A6500 + A11673 + A12080 + A1510 + A3924 + 
                           A5324 + A7477 + A7831 + A12434 + A948 + A1662 + A7158 + A10441 + 
                           A10637 + A307 + A966 + A2032 + A4177 + A5084 + A5313 + A6674 + 
                           A9085 + A10464 + A12446 + A3091 + A8003 + A8388 + A8564 + 
                           A11674 + A3309 + A3613 + A4870 + A7233 + A9495 + A10306 + 
                           A10357 + A2628 + A6294 + A8303 + A9124 + A527 + A2961 + A4271 + 
                           A6933 + A7809 + A8855 + A11085 + A12251 + A591 + A2144 + 
                           A10118 + A11892 + A12199 + A862 + A1232 + A3919 + A4526 + 
                           A5874 + A5919 + A7198 + A8414 + A10809 + A12395 + A82 + A3097 + 
                           A11448 + A4567 + A8520 + A10640 + A12099 + A610 + A2443 + 
                           A4496 + A5661 + A6041 + A7948 + A8918 + A10354 + A11600 + 
                           A499 + A3257 + A5701 + A6995 + A9220 + A11318 + A12281 + 
                           A77 + A1677 + A5559 + A7338 + A8683 + A8857 + A9427 + A10859 + 
                           A468 + A2046 + A6988 + A8791 + A11436 + A3405 + A4309 + A4346 + 
                           A7630 + A9571 + A10948 + A114 + A777 + A969 + A2577 + A3196 + 
                           A4971 + A5770 + A7061 + A7964 + A9973 + A2303 + A2780 + A2808 + 
                           A4506 + A7317 + A7886 + A6864 + A7067 + A7325 + A7350 + A10860 + 
                           A137 + A7536 + A9094 + A11043 + A11116 + A2817 + A3112 + 
                           A7052 + A9763 + A10310 + A10866 + A10993 + A12358 + A2108 + 
                           A2310 + A5388 + A6042 + A8315 + A8793 + A9965 + A338 + A361 + 
                           A4621 + A4828 + A5375 + A5776 + A7080 + A10656 + A11791 + 
                           A12046 + A1514 + A2247 + A4024 + A5804 + A6522 + A10392 + 
                           A11739 + A445 + A3976 + A6085 + A9457 + A11188 + A2071 + 
                           A2311 + A4317 + A4472 + A5299 + A7307 + A8330 + A9945 + A11731 + 
                           A12274 + A7421 + A9025 + A10421 + A11887 + A12198 + A2091 + 
                           A3530 + A5901 + A7652 + A9073 + A10918 + A5071 + A5132 + 
                           A7672 + A8027 + A8870 + A9005 + A9142 + A9496 + A10665 + 
                           A234 + A533 + A4945 + A5348 + A6297 + A8853 + A9870 + A10121 + 
                           A12088 + A2880 + A3945 + A5382 + A5569 + A5838 + A5960 + 
                           A7287 + A8028 + A9767 + A10969 + A11108 + A11120 + A11681 + 
                           A126 + A1838 + A2075 + A2585 + A6256 + A6876 + A7810 + A8466 + 
                           A10371 + A10826 + A6589 + A8026 + A11338 + A11521 + A3709 + 
                           A5852 + A8940 + A398 + A3525 + A4722 + A6224 + A7021 + A7193 + 
                           A8760 + A10871 + A11526 + A12156 + A12183 + A12278 + A1277 + 
                           A1678 + A2189 + A2259 + A3534 + A4015 + A5967 + A7062 + A8599 + 
                           A10241 + A11198 + A259 + A408 + A1881 + A5086 + A9283 + A10092 + 
                           A11433 + A11557 + A2242 + A4884 + A5606 + A5639 + A9704 + 
                           A9791 + A9806 + A904 + A1231 + A2092 + A3193 + A5232 + A5471 + 
                           A5886 + A8053 + A8238 + A8616 + A9911 + A10992 + A431 + A1585 + 
                           A4951 + A5866 + A6101 + A8681 + A9750 + A11648 + A12196 + 
                           A12305 + A12531 + A866 + A5385 + A7094 + A11873 + A351 + 
                           A978 + A3103 + A3657 + A3730 + A4263 + A4687 + A4705 + A6127 + 
                           A7278 + A7360 + A8242 + A8376 + A8560 + A11627, data = Train_Data, method = "svmLinear",
                         trControl=trctrl,
                         preProcess = c("center", "scale"),
                         tuneGrid = grid,
                         tuneLength = 10)
print(svm_Linear_Grid)
plot(svm_Linear_Grid)
test_pred_grid <- predict(svm_Linear_Grid, newdata = Test_Data)
test_pred_grid
confusionMatrix(test_pred_grid, Test_Data$A1 )


#Information Gain to find the most Important Gene
library(CORElearn)
IG.CORElearn <- attrEval(A1 ~ ., data=Train_Data,  estimator = "InfGain")
IG.CORElearn = data.frame(IG.CORElearn)
library(tidyverse)
library(tidyquant)

acc = 97.20


#install.packages("tidyquant")

my_data <- as_tibble(IG.CORElearn)
my_data %>% arrange(desc(IG.CORElearn>0.3))
View(my_data)

#Most important GENE
max.row <- row.names(IG.CORElearn)[(which(IG.CORElearn > 0.4))]
print(max.row)

#Multilayer Perceptron Implementation
install.packages("keras")
library(keras)
install_keras()
#Read Data
lungcancer=read.csv("/Users/Asish/Downloads/MAIN PROJECT/LungCancer-Harvard2/data.csv", header = T)
lungcancer
str(lungcancer)
lungcancer$A1=factor(lungcancer$A1)
#Changing data to matrix
lungcancerMatrix=as.matrix(lungcancer)
#To remove default names
dimnames(lungcancerMatrix)<-NULL
str(lungcancerMatrix)
ncol(lungcancer)
lungcancerMatrix[,1]<-as.numeric(lungcancerMatrix[,1])
#Data Partition
set.seed(1234) #to make our results repeatable
ind=sample(2, nrow(lungcancerMatrix), replace = T, prob = c(0.7,0.3))
training=lungcancerMatrix[ind==1, 2:12534]
testing=lungcancerMatrix[ind==2, 2:12534]
trainingtarget=lungcancerMatrix[ind==1, 1]
testtarget=lungcancerMatrix[ind==2, 1]
#One Hot Encoding
trainlabels=to_categorical(trainingtarget) #to convert class vector into binary class matrix
testlabels=to_categorical(testtarget)
print(trainlabels)
print(testlabels)
#Create Sequential Model
model= keras_model_sequential()
model %>%
  layer_dense(units=8,activation = 'relu',input_shape = c(12533))%>% #nueral network is densely connected relu=rectified linear units
  layer_dense(units = 2,activation = 'softmax')   #softmax activation layer in output layer is used to keep ranges between 0 and 1
summary(model)
#Compile
model%>%
  compile(loss= 'categorical_crossentropy', #categorical cross function used for 2 categorical situation
          optimizer='adam',
          metrics='accuracy')
#Fit Model(MultiLayer Perceptron)
history= model %>%
          fit(training,
              trainlabels,
              epoch= 200,
              batch_size= 32,
              validation_split= 0.2)
plot(history)
#Evaluate model using test data
model %>%
  evaluate(testing,testlabels)
#Prediction and confusion matrix on test data
prob= model%>%
  predict_proba(testing)

pred=model %>%
  predict_classes(testing)
table(Predicted= pred, Actual= testtarget)
cbind(prob,pred,testtarget)
Print(acc)